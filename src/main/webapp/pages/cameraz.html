<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <!-- <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"> -->
    <title>Robot-l1Console</title>
    <script>//这部分需要hangbege.js的都要有
    // 定义全局变量存储上下文路径//
    function getContextPath() {
        const pathName = window.location.pathname;
        console.log('pathName:', pathName);
        // 查找第二个 / 的索引
        // 处理可能找不到的情况
        let index = pathName.indexOf("pages");
        if (index !== -1) {
            console.log("找到pages，索引位置:", index);
        } else {
            console.log("未找到pages");
        }
        return pathName.substring(0, index - 1);
    }
    const contextPath = getContextPath();
    console.log('上下文路径:', contextPath);


    // 动态加载udp视频处理脚本的函数
    function loadUdpvideo_resovlerScript(src, onLoad, onError) {
        const script = document.createElement('script');
        script.src = src;
        script.onload = onLoad;
        script.onerror = onError;
        document.head.appendChild(script);
    }

    loadUdpvideo_resovlerScript(
        contextPath + '/pages/css/udpvideo_resovler.js',
        () => {console.log('udpvideo_resovler.js 加载成功');startrec()},
        () => console.error('udpvideo_resovler.js 加载失败')
    );
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            position: fixed;
            width: 100vw;
            display: flex;
            height: 100vh;
            overflow: hidden;
            justify-content: center;
            align-items: center;
            padding: 0.3vh 3vh 0.3vh 5vh;
            font-family: 'Segoe UI', system-ui, sans-serif;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            /* 高级深色渐变背景 */
            background:
                radial-gradient(circle at 20% 30%, rgba(65, 20, 120, 0.3) 0%, transparent 40%),
                radial-gradient(circle at 80% 70%, rgba(0, 100, 200, 0.2) 0%, transparent 40%),
                linear-gradient(135deg, #0a0e17 0%, #13182b 50%, #0d1425 100%);
            z-index: -1;
        }

        .hero {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .content1 {
            /* 高级玻璃态效果 */
            background: linear-gradient(135deg,
                    rgba(25, 30, 50, 0.85) 0%,
                    rgba(15, 20, 40, 0.9) 100%);
            backdrop-filter: blur(15px) saturate(150%);
            -webkit-backdrop-filter: blur(15px) saturate(150%);
            border-radius: 2.5vh;
            padding: 0.5vh 2.5vh;
            box-shadow:
                0 1.5vh 3vh rgba(0, 0, 0, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.08);
            display: flex;
            flex-direction: column;
            height: 100%;
            overflow: hidden;
            position: relative;
        }

        /* 添加装饰性光效 */
        .content1::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg,
                    transparent 0%,
                    rgba(100, 150, 255, 0.4) 20%,
                    rgba(100, 150, 255, 0.6) 50%,
                    rgba(100, 150, 255, 0.4) 80%,
                    transparent 100%);
            z-index: 1;
        }

        h2 {
            text-align: center;
            font-size: 1rem;

            background: linear-gradient(90deg, #6a8cff, #a66cff, #6a8cff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 2vh rgba(106, 140, 255, 0.5);
            font-weight: 600;
            letter-spacing: 0.5px;
            position: relative;
            padding-bottom: 0.3vh;
        }

        h2::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 25%;
            width: 50%;
            height: 2px;
            background: linear-gradient(90deg, transparent, #6a8cff, transparent);
        }

        .status-indicator {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 2vh;
        }

        .status {
            padding: 0.8vh 2.5vh;
            border-radius: 2vh;
            font-weight: 600;
            background: linear-gradient(135deg, #2ed573, #1db954);
            box-shadow: 0 0 1.5vh rgba(46, 213, 115, 0.4);
            font-size: clamp(0.8rem, 2vw, 0.9rem);
            color: white;
            position: relative;
            overflow: hidden;
        }

        .status::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg,
                    transparent,
                    rgba(255, 255, 255, 0.4),
                    transparent);
            transition: left 0.5s;
        }

        .status:hover::before {
            left: 100%;
        }

        .control-panel {
            display: flex;
            flex-direction: row;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
            gap: 2vh;

            flex: 1;
            overflow: hidden;
        }

        .slider-container {
            width: 10%;
            display: flex;
            flex-direction: column;
            justify-content: end;
            align-items: center;


            height: 95%;
        }

        .slider-label {

            font-weight: 600;
            color: #b8c7ff;
            font-size: clamp(0.8rem, 2vw, 0.9rem);
            text-align: center;
            text-shadow: 0 0 5px rgba(184, 199, 255, 0.3);
        }

        .vertical-slider {

            width: 10%;
            height: 100%;
            background: rgba(10, 15, 30, 0.7);
            border-radius: 1.5vh;
            outline: none;
            border: 1px solid rgba(100, 150, 255, 0.2);
            box-shadow:
                inset 0 2px 4px rgba(0, 0, 0, 0.5),
                0 1px 0 rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
            transform: scaleX(5);
            writing-mode: vertical-lr;
            direction: rtl;
            -webkit-appearance: slider-vertical;
            appearance: slider-vertical;

        }

        .vertical-slider:hover {
            border-color: rgba(100, 150, 255, 0.4);
            box-shadow:
                inset 0 2px 4px rgba(0, 0, 0, 0.5),
                0 1px 0 rgba(255, 255, 255, 0.1),
                0 0 10px rgba(100, 150, 255, 0.2);
        }



        #straightSlider {
            position: relative;
            background-image: linear-gradient(to right,
                    rgba(255, 255, 255, 0.1) 0.1vh,
                    transparent 0.1vh);
            background-size: 20% 100%;
            background-repeat: no-repeat;
        }

        .video-container {
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            background: rgba(10, 15, 30, 0.6);
            border-radius: 1.5vh;
            padding: 0.5vh 0vh;
            border: 1px solid rgba(100, 150, 255, 0.15);
            box-shadow:
                0 0.5vh 1.5vh rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.05);
            width: 50%;
            overflow: hidden;
            position: relative;
        }



        #videoDat {
            width: 100%;
            height: 70%;
            border-radius: 1vh;
            box-shadow: 0 0 2vh rgba(0, 0, 0, 0.5);
            background: #000;
            border: 1px solid rgba(100, 150, 255, 0.2);
            object-fit: contain;
        }

        .controls {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 1vh;

            width: 100%;
            height: 10%;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0 0.5vh;
        }

        .control-group-title {
            font-size: clamp(0.7rem, 2vw, 0.8rem);
            margin-bottom: 1vh;
            color: #b8c7ff;
            font-weight: 600;
            text-align: center;
            text-shadow: 0 0 5px rgba(184, 199, 255, 0.3);
        }

        button {
            background: linear-gradient(135deg, #3a4a7a, #2a3a6f);
            color: white;
            border: none;
            padding: 0.3vh 0.3vh;
            margin: 0.4vh;
            border-radius: 1vh;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow:
                0 0.4vh 0.8vh rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            width: 20vw;
            height: 100%;
            font-size: clamp(0.7rem, 2vw, 0.85rem);
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(100, 150, 255, 0.2);
        }

        button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg,
                    transparent,
                    rgba(255, 255, 255, 0.2),
                    transparent);
            transition: left 0.5s;
        }

        button:hover {
            transform: translateY(-0.2vh);
            box-shadow:
                0 0.6vh 1.2vh rgba(0, 0, 0, 0.4),
                0 0 15px rgba(106, 140, 255, 0.3);
            background: linear-gradient(135deg, #4a5a8a, #3a4a7f);
        }

        button:hover::before {
            left: 100%;
        }

        button:active {
            transform: translateY(0);
            box-shadow:
                0 0.2vh 0.4vh rgba(0, 0, 0, 0.3),
                inset 0 1px 2px rgba(0, 0, 0, 0.2);
        }

        .pwm-controls {
            display: flex;
            flex-direction: column;
            align-items: center;
            background: rgba(10, 15, 30, 0.6);
            border-radius: 1.5vh;
            padding: 2vh;
            margin-top: 2vh;
            border: 1px solid rgba(100, 150, 255, 0.15);
            box-shadow:
                0 0.5vh 1vh rgba(0, 0, 0, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.05);
            position: relative;
        }

        .pwm-controls::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 1.5vh;
            padding: 1px;
            background: linear-gradient(135deg,
                    rgba(100, 150, 255, 0.2),
                    rgba(166, 108, 255, 0.1));
            -webkit-mask:
                linear-gradient(#fff 0 0) content-box,
                linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
            pointer-events: none;
        }

        .pwm-title {
            font-size: clamp(1rem, 3vw, 1.1rem);
            margin-bottom: 1.5vh;
            color: #b8c7ff;
            text-shadow: 0 0 5px rgba(184, 199, 255, 0.3);
        }

        .pwm-inputs {
            display: flex;
            gap: 2vh;
            margin-bottom: 1.5vh;
            flex-wrap: wrap;
            justify-content: center;
        }

        .pwm-input {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .pwm-input label {
            margin-bottom: 0.8vh;
            font-size: clamp(0.7rem, 2vw, 0.85rem);
            color: #b8c7ff;
        }

        input[type="number"] {
            padding: 1vh;
            border-radius: 0.8vh;
            border: 1px solid rgba(100, 150, 255, 0.3);
            background: rgba(10, 15, 30, 0.7);
            color: white;
            width: clamp(100px, 20vw, 130px);
            text-align: center;
            font-size: clamp(0.8rem, 2vw, 0.9rem);
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.5);
            transition: all 0.3s ease;
        }

        input[type="number"]:focus {
            outline: none;
            border-color: rgba(100, 150, 255, 0.6);
            box-shadow:
                inset 0 1px 3px rgba(0, 0, 0, 0.5),
                0 0 8px rgba(100, 150, 255, 0.3);
        }

        .horizontal-slider-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            margin-top: 0.5vh;
            height: 10%;
            margin-top: auto;
        }

        .horizontal-slider {
            width: 80%;

            margin: 0.2vh 0;
            transform: scaleY(4);

        }

        @media screen and (max-width: 12000px) and (orientation: portrait) {
            body {
                height: 100vw;
                width: 100vh;
                top: 50vh;
                left: 50vw;
                margin-top: -50vw;
                margin-left: -50vh;
                transform: rotate(-90deg);
                transform-origin: center center;
            }
        }

        @media screen and (max-width: 768px) {}
        .toast {
            position: fixed; top: 50vh; right: 43vw;
            background: #333; color: white; padding: 12px;
            border-radius: 4px; z-index: 1000;
        }
    </style>
</head>

<body>
    <section class="hero">
        <div class="content1">
            <h2>Robot-l1Console</h2>

            <!-- <div class="status-indicator">
                <div id="status" class="status">观察窗</div>
            </div> -->

            <div class="control-panel">
                <div class="slider-container">
                    <div class="slider-label">左控制</div>

                    <input type="range" min="-5" max="5" value="0" class="vertical-slider" id="leftSlider"
                        orient="vertical">

                </div>

                <div class="slider-container">
                    <div class="slider-label">上下调整视角</div>
                    <input type="range" min="5" max="25" value="15" id="upSlider" class="vertical-slider"
                        orient="vertical">
                </div>

                <div class="video-container">
                    <img id="videoDat" src="" alt="等待视频数据">

                    <div class="controls">
                        <div class="control-group">
                            <button id="startvideo" onclick="startvideo()">开始观察</button>

                        </div>

                        <div class="control-group">
                            <button id="stopvideo" onclick="stopvideo()">停止观察</button>

                        </div>

                        <div class="control-group">

                            <button id="rightstopButton" onclick="sendMessageToWebSocket(6)">紧急制动</button>

                        </div>
                    </div>

                    <div class="horizontal-slider-container">
                        <!-- <div class="slider-label">水平调整视角</div> -->
                        <input type="range" min="-25" max="-5" value="-15" id="diSlider" class="horizontal-slider">
                    </div>
                </div>

                <div class="slider-container">
                    <div class="slider-label">右控制</div>
                    <input type="range" min="-5" max="5" value="0" class="vertical-slider" id="rightSlider"
                        orient="vertical">
                </div>

                <div class="slider-container">
                    <div class="slider-label">直线控制</div>
                    <input type="range" min="-5" max="5" value="0" class="vertical-slider" id="straightSlider"
                        orient="vertical">
                </div>
            </div>

            <!-- <div class="pwm-controls">
                <div class="pwm-title">PWM 设置</div>
                <div class="pwm-inputs">
                    <div class="pwm-input">
                        <label for="analogWriteFreq">频率 (Hz)</label>
                        <input type="number" id="analogWriteFreq" name="analogWriteFreq" min="1" max="1000" value="1000">
                    </div>
                    <div class="pwm-input">
                        <label for="analogWriteRange">范围 (1-255)</label>
                        <input type="number" id="analogWriteRange" name="analogWriteRange" min="1" max="255" value="255">
                    </div>
                </div>
                <button id="analogWriteButton">发送 PWM 设置</button>
            </div> -->
        </div>
    </section>
    <script>
        //视频转发控制

        async function startvideo() {
            function showToast(message, type = "info") {
                const toast = document.createElement("div");
                toast.className = `toast ${type}`;
                toast.textContent = message;
                document.body.appendChild(toast);

                setTimeout(() => toast.remove(), 3000);
            }
            showToast("正在准备传输", "success");
            await fetch('https://linyi.love:25572/videostart',);

            const mainMessageInterval = setInterval(() => {
                startrec();
                clearInterval(mainMessageInterval);

            }, 3000);

        }
        async function stopvideo() {
            await fetch('https://linyi.love:25572/videostop',)
        }

        const wsUrl_control = 'wss://' + 'linyi.love' + ':/car/user';

        const websocket_ctrl = new WebSocket(wsUrl_control);
        websocket_ctrl.binaryType = 'arraybuffer';
        const zhiling = new Uint8Array(5);
        function sendMessageToWebSocket(message) {
            if (websocket_ctrl.readyState === WebSocket.OPEN) {

                zhiling[0] = 109;
                zhiling[1] = 111;
                zhiling[2] = 118;
                zhiling[3] = 101;
                zhiling[4] = message;
                websocket_ctrl.send(zhiling);
            } else {
                console.error("WebSocket 连接未打开");
            }
        }
        //滑动杆相关
        const leftSlider = document.getElementById("leftSlider");
        const rightSlider = document.getElementById("rightSlider");
        const upSlider = document.getElementById("upSlider");
        const diSlider = document.getElementById("diSlider");
        const straightSlider = document.getElementById("straightSlider");
        leftSlider.addEventListener("input", function () {
            if (leftSlider.value > 0) {
                sendfuzaMessageToWebSocket(9, getspeed(leftSlider.value, "left"));
            } else if (leftSlider.value < 0) {
                sendfuzaMessageToWebSocket(10, getspeed((-leftSlider.value).toString(), "left"));
            } else {
                sendfuzaMessageToWebSocket(10, 0);
            }

        })
        rightSlider.addEventListener("input", function () {
            if (rightSlider.value > 0) {
                sendfuzaMessageToWebSocket(7, getspeed(rightSlider.value, "right"));
            } else if (rightSlider.value < 0) {
                sendfuzaMessageToWebSocket(8, getspeed((-rightSlider.value).toString(), "right"));
            } else {
                sendfuzaMessageToWebSocket(8, 0);
            }
        })
        upSlider.addEventListener("input", function () {
            sendfuzaMessageToWebSocket(14, upSlider.value);

        })
        diSlider.addEventListener("input", function () {
            sendfuzaMessageToWebSocket(15, -diSlider.value);
        })
        straightSlider.addEventListener("input", function () {
            if (straightSlider.value > 0) {
                switch (straightSlider.value) {
                    case '1':

                        sendStraightMessageToWebSocket(11, 20, 15);
                        break;
                    case '2':
                        sendStraightMessageToWebSocket(11, 27, 16);
                        break;
                    case '3':
                        sendStraightMessageToWebSocket(11, 94, 52);
                        break;
                    case '4':
                        sendStraightMessageToWebSocket(11, 180, 100);
                        break;
                    case '5':
                        sendStraightMessageToWebSocket(11, 200, 110);
                        break;
                }

            } else if (straightSlider.value < 0) {
                switch (straightSlider.value) {
                    case '-1':
                        sendStraightMessageToWebSocket(12, 20, 15);
                        break;
                    case '-2':
                        sendStraightMessageToWebSocket(12, 27, 16);
                        break;
                    case '-3':
                        sendStraightMessageToWebSocket(12, 94, 52);
                        break;
                    case '-4':
                        sendStraightMessageToWebSocket(12, 180, 100);
                        break;
                    case '-5':
                        sendStraightMessageToWebSocket(12, 200, 110);
                        break;
                }
            } else {
                sendMessageToWebSocket(6);
            }
        })
        const fuzazhiling = new Uint8Array(7);
        function sendfuzaMessageToWebSocket(message, speed) {
            if (websocket_ctrl.readyState === WebSocket.OPEN) {

                fuzazhiling[0] = 109;
                fuzazhiling[1] = 111;
                fuzazhiling[2] = 118;
                fuzazhiling[3] = 101;
                fuzazhiling[4] = message;
                // fuzazhiling[5] = speed;//右边
                // fuzazhiling[6] = (speed);//左边
                fuzazhiling[5] = speed;//右边
                fuzazhiling[6] = speed;//左边
                websocket_ctrl.send(fuzazhiling);
            } else {
                console.error("WebSocket 连接未打开");
            }
        }
        function sendStraightMessageToWebSocket(message, speedl, speedr) {
            if (websocket_ctrl.readyState === WebSocket.OPEN) {

                fuzazhiling[0] = 109;
                fuzazhiling[1] = 111;
                fuzazhiling[2] = 118;
                fuzazhiling[3] = 101;
                fuzazhiling[4] = message;
                // fuzazhiling[5] = speed;//右边
                // fuzazhiling[6] = (speed);//左边
                fuzazhiling[5] = speedr;//右边
                fuzazhiling[6] = speedl;//左边
                websocket_ctrl.send(fuzazhiling);
            } else {
                console.error("WebSocket 连接未打开");
            }
        }
        function getspeed(nunber, direction) {
            let speed;

            if (direction == "right") {
                switch (nunber) {
                    case '1':
                        speed = 15;
                        break;
                    case '2':
                        speed = 16;
                        break;
                    case '3':
                        speed = 52;
                        break;
                    case '4':
                        speed = 100;
                        break;
                    case '5':
                        speed = 110;
                        break;
                }
            } else {
                switch (nunber) {
                    case '1':
                        speed = 20;
                        break;
                    case '2':
                        speed = 27;
                        break;
                    case '3':
                        speed = 94;
                        break;
                    case '4':
                        speed = 180;
                        break;
                    case '5':
                        speed = 200;
                        break;
                }
            }
            return speed;
        }
        //pwm相关
        const analogWriteFreq = document.getElementById("analogWriteFreq");
        const analogWriteRange = document.getElementById("analogWriteRange");
        const pwmzhiling = new Uint8Array(8);
        function sendAnalogWrite() {
            if (websocket_ctrl.readyState === WebSocket.OPEN) {
                pwmzhiling[0] = 109;
                pwmzhiling[1] = 111;
                pwmzhiling[2] = 118;
                pwmzhiling[3] = 101;
                pwmzhiling[4] = 13;
                pwmzhiling[5] = analogWriteFreq.value / 256;
                pwmzhiling[6] = analogWriteFreq.value % 256;
                pwmzhiling[7] = analogWriteRange.value;
                websocket_ctrl.send(pwmzhiling);
            }
        }
        // 在文件顶部添加全局开关
        const LOG_ENABLED = false; // 设为false即可关闭所有日志

        // 替换所有console.log为条件输出
        function log(...args) {
            if (LOG_ENABLED) {
                console.log(...args);
            }
        }



        function startrec() {
            const imgElement = document.getElementById('videoDat');
            window.imgelement=imgElement;
            const blob = new Blob([workerCode], { type: 'application/javascript' });
            const workerUrl = URL.createObjectURL(blob);
            // 使用内联Worker
            const videoWorker = new Worker(workerUrl);
            window.videoWork = videoWorker; // 显式全局
            //const videoWorker = new Worker('worker.js');

            // 接收Worker处理结果
            videoWorker.onmessage = function (e) {
                const imageData = e.data;
                // console.log("最终处理结果："+e.data);            //console.error("2线程处理好照片交给主线程显示："+Date.now());
                displayImage(imageData, 'image/jpeg');
                // console.log("显示完毕："+Date.now());
            };




            //
            //接收视频数据
            //
            /////////////////////////////////////////////////////////////////////////////////
            // 创建流URL映射对象
            let streamURLs;

            // 动态生成URL
            streamURLs = `https://linyi.love:4444/webtransport`;

            beforeStartStreaming(streamURLs);
            async function beforeStartStreaming(streamURLs) {
                startStreaming(streamURLs);
            }

            async function startStreaming(url) {
                try {
                    // 使用 AbortController
                    const controller = new AbortController();
                    const timeoutId = setTimeout(() => controller.abort(), 1000 * 600); // 10分钟超时
                    //webtransport
                    const transport = new WebTransport(url);
                    // The connection can be used once ready fulfills
                    await transport.ready;

                    const reader = transport.datagrams.readable.getReader();
                    //const stream = await transport.createBidirectionalStream();
                    // stream.readable is a WebTransportReceiveStream
                    //const readable = stream.readable;
                    // stream.writable is a WebTransportSendStream
                    //const writable = stream.writable;
                    //const reader = readable.getReader();
                    const writer = transport.datagrams.writable.getWriter();
                    // const data1 = new Uint8Array([65, 66, 67]);
                    // const data2 = new Uint8Array([68, 69, 70]);
                    clearTimeout(timeoutId);
                    console.log("开始连接:" + url);
                    //检查响应状态
                    // if (!response.ok) {
                    //     throw new Error(`HTTP错误! 状态码: ${response.status}`);
                    // }

                    // console.log("开始接收视频流");
                    // transportButton.addEventListener('click', function () {
                    //     writer.write(data1);
                    //     writer.write(data2);
                    // })

                    while (true) {
                        try {
                            //console.log("我又来了");
                            const { done, value } = await reader.read();

                            if (done) {
                                console.log("视频流结束");
                                break;
                            }
                            if (value.byteLength == 0) {
                                console.log("value.byteLength==0");
                                continue;
                            }
                            // 处理接收到的视频数据

                            //console.log(`接收到 ${value.byteLength} 字节数据`);
                            addmessage(value);
                        } catch (error) {
                            console.error("读取数据错误:", error);
                            break;
                        }
                    }
                } catch (error) {
                    console.log(`连接错误: ${error.message}`);
                }
            }
            ////////////////////////////////////////////
        }
    </script>
</body>

</html>